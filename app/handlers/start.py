from aiogram.filters import CommandStart
from aiogram import types, F, Bot, Router
from pathlib import Path
from aiogram.types import ReplyKeyboardRemove, FSInputFile, CallbackQuery
from app.keyboards.user_keyboards import main_keyboard, user_inline_menu


router = Router()


@router.message(CommandStart())
async def start_command(message: types.Message, bot: Bot):
    """
    –≠—Ç–æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–º–∞–Ω–¥–µ /start. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Ñ–æ—Ç–æ.
    """
    image_path = Path("./img/start.jpg")

    if not image_path.exists():
        await message.reply("–û—à–∏–±–∫–∞: –§–∞–π–ª start.jpg –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–∞–ø–∫–µ img!")
        return

    try:
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º FSInputFile –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è, —á—Ç–æ —ç—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª
        photo = FSInputFile(path=str(image_path))

        await bot.send_photo(
            chat_id=message.chat.id,
            photo=photo,  # –ü–µ—Ä–µ–¥–∞–µ–º FSInputFile
            caption=(
                f"""–ë–æ—Ç  "–ú–û–ò –ü–†–ò–ù–¶–ò–ü–´ " ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –≤ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è, –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –≤–∞–º –æ –≤–∞—à–∏—Ö –∂–∏–∑–Ω–µ–Ω–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç—è—Ö, –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∏—Ç—å—Å—è –∏–º–∏ —Å –±–ª–∏–∑–∫–∏–º–∏ –∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∫–∞–∫ –Ω–∞—Å–ª–µ–¥–∏–µ –¥–µ—Ç—è–º!
–§—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞:
1. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö: –ë–æ—Ç –±—É–¥–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ , –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å –≤–∞–º –æ –≤–∞—à–∏—Ö –∂–∏–∑–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏ –∏ –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å –æ —Ç–æ–º, —á—Ç–æ –¥–ª—è –≤–∞—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω–æ.
2. –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤: –í—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª—è—Ç—å —Å–≤–æ–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã.
3. –î–µ–ª–∏—Ç–µ—Å—å —Å –¥—Ä—É–∑—å—è–º–∏ –∏ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –≤–∞—à–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –¥–µ—Ç—è–º: –•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –≤–∞—à–∏ –¥—Ä—É–∑—å—è, –¥–µ—Ç–∏, –≤–æ—Å–ø–∏—Ç–∞–Ω–Ω–∏–∫–∏ —Ç–æ–∂–µ –∑–Ω–∞–ª–∏ –æ –≤–∞—à–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö? –ë–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∏—Ç—å—Å—è –∏–º–∏ —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–∑–¥–∞–≤–∞—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –≤–∞—à–∏–º–∏ —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏."""
            ),
            reply_markup=main_keyboard
        )
    except Exception as e:
        await message.reply(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ç–æ: {e}")


@router.message(F.text.regexp(r".*–ú–µ–Ω—é.*"))
async def menu_button_handler(message: types.Message):
    """
    –≠—Ç–æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏, —Ç–µ–∫—Å—Ç –∫–æ—Ç–æ—Ä–æ–π —Å–æ–¥–µ—Ä–∂–∏—Ç "–ú–µ–Ω—é", –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ.
    """
    await message.answer(
        "–í—ã –Ω–∞–∂–∞–ª–∏ –∫–Ω–æ–ø–∫—É, —Å–æ–¥–µ—Ä–∂–∞—â—É—é '–ú–µ–Ω—é' (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è).",
        reply_markup=user_inline_menu
    )


@router.message(F.text.regexp(r".*–ü–æ–º–æ—â—å.*"))
async def help_handler(message: types.Message) -> None:
    """
    –≠—Ç–æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "–ü–æ–º–æ—â—å".
    """
    await message.answer(
        "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
        "/start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n"
        "–ú–µ–Ω—é - –û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏\n"
        "–ü–æ–º–æ—â—å - –ü–æ–ª—É—á–∏—Ç—å —Å–ø—Ä–∞–≤–∫—É\n"
        "\n"
        "**–û–ø–∏—Å–∞–Ω–∏–µ –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é:**\n"
        "‚è≥ –í—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞.\n\n"
        "‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø - –î–æ–±–∞–≤–ª—è–µ—Ç –æ–¥–∏–Ω –ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.\n\n"
        "üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã –∏–∑ —Ñ–∞–π–ª–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.\n\n"
        "üíæ –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏, —Ö—Ä–∞–Ω—è—â–∏–º–∏—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.\n\n"
        "üóë –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã - –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã!) –ü—Ä–∏ —ç—Ç–æ–º –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∞–º –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞.\n\n"
    )